@{
    Layout = ViewBag.Layout;
    Skoda_DCMS.Models.DesktopLaptopInstallationChecklistModel DLIC = null;
    DLIC = ViewBag.Model?.one[0] as Skoda_DCMS.Models.DesktopLaptopInstallationChecklistModel;
    var appList = ViewBag.Model?.three as List<Skoda_DCMS.Models.ApprovalDataModel>;
}
@if (DLIC != null)
{
    <!DOCTYPE html>
    <html>
    <head>
        <title>SAVWIPL - Desktop Laptop CheckList Form</title>
        <style type="text/css">
            *:visited, *:focus {
                box-shadow: none;
            }

            input, select, input:focus, select:focus, textarea, textarea:focus {
                border: 1px solid #000;
            }

            input, textarea {
                padding: 5px;
            }

            table td {
                padding: 5px;
            }

            .mr-2 {
                margin-right: 10px;
            }

            .w100-input input {
                width: 100%;
            }

        </style>
    </head>
    <body>

        <table style="width: 100%; font-size: 14px; color: #000; font-weight: 600;" border="1" cellspacing="0" cellpadding="0">
            <tr>
                <td>
                    <table style="width: 100%;" cellspadding="0" cellspacing="0">
                        <tr>
                            <td colspan="6" width="60%" style="text-align: right;">
                                <img style="width: 50%;" src='@Server.MapPath("~/assets/img/SAVWIPL_Merger_Logo.JPG")'>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="center">
                    <h2>Desktop Laptop CheckList Form</h2>
                </td>
            </tr>

            <tr>
                <td style="padding: 15px;">
                    <table border="0" cellspacing="0" cellpadding="0" width="100%">
                        <tr class="w100-input">
                            <td style="width:20%; font-weight: bold;">
                                Ticket Number
                            </td>
                            <td align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.TicketNum)" />
                            </td>
                        </tr>
                        <tr class="w100-input">
                            <td style="width:20%; font-weight: bold;">
                                Employee Name
                            </td>
                            <td style="width: 30%; font-weight: normal;" colspan="2" align='left'>
                                <input value="@(DLIC?.T_EmployeeName)" />
                            </td>
                            <td style="width:20%; font-weight: bold;">
                                Make
                            </td>
                            <td colspan="2" align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.Make)" />
                            </td>

                        </tr>

                        <tr class="w100-input">
                            <td style="width:20%; font-weight: bold;">
                                Employee Code
                            </td>
                            <td style="width: 30%; font-weight: normal" colspan="2" align='left'>
                                <input value="@(DLIC?.T_EmployeeCode)" />
                            </td>
                            <td style="width:20%; font-weight: bold;">
                                Model
                            </td>
                            <td colspan="2" align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.Modal)" />
                            </td>
                        </tr>
                        <tr class="w100-input">
                            <td style="width:20%; font-weight: bold;">
                                UserID
                            </td>
                            <td colspan="2" align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.T_UserId)" />
                            </td>
                            <td style="width:20%; font-weight: bold;">
                                Serial Number
                            </td>
                            <td colspan="2" align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.SerialNumber)" />
                            </td>

                        </tr>

                        <tr class="w100-input">
                            <td style="width:20%; font-weight: bold;">
                                Cost Center Number
                            </td>
                            <td colspan="2" align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.T_CostCenter)" />
                            </td>
                            <td style="width:20%; font-weight: bold;">
                                Host Name
                            </td>
                            <td colspan="2" align='left' style="width: 30%; font-weight: normal">
                                <input value="@(DLIC?.HostName)" />
                            </td>
                        </tr>

                        <tr >
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="iDoCompleted" name="reqType" @(DLIC?.IsIDoCompleted == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> i.Do Completed </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="vpnConfiguration" name="reqType" @(DLIC?.IsVPNConfigurationDone == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> VPN Configuration Done (Laptop Only) Configuration </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="bitlocker" name="reqType" @(DLIC?.IsBitLockerCompleted == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Bitlocker </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="sharedFolderAccess" name="reqType" @(DLIC?.IsSharedFolderAccessDone == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Shared Folder Access Done </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="antivirusUpdate" name="reqType" @(DLIC?.IsAntivirusUpdated == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Antivirus Updates Checked </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="dataRestored" name="reqType" @(DLIC?.IsDataRestored == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Data Restored (for Replacement/re-i.do) </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="zScalerProxy" name="reqType" @(DLIC?.IsProxyConfig == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Zscaler/Proxy Configuration </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="nessusAgent" name="reqType" @(DLIC?.IsNessusAgent == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Nessus Agent </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="usbBluetooth" name="reqType" @(DLIC?.IsUSBBluetoothDisabled == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> USB/Bluetooth Disabled </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="addInOfficeAzure" name="reqType" @(DLIC?.IsClassificationAddInForOffice == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Classification add-in for Office / Azure Info Project </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="userIdConfig" name="reqType" @(DLIC?.IsUserIdConfigured == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> User ID Configured </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="outlookConfiguration" name="reqType" @(DLIC?.IsOutLookConfiguration == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Outlook Configuration </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="fireEyeAgent" name="reqType" @(DLIC?.IsFirEyeAgent == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> FireEye Agent </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="usedMachineClean" name="reqType" @(DLIC?.IsUsedMachineToBeClean == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Used Machine to be cleaned </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="encryptedEmailConfig" name="reqType" @(DLIC?.IsEncryptedEmailConfiguration == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Encrypted Email Configuration </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="oneDriveConfig" name="reqType" @(DLIC?.IsOneDriveConfiguration == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> OneDrive Configuration </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="pkiCardDigitalSign" name="reqType" @(DLIC?.IsPKIDigitSignCert == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> PKI Card & Digital Signature Setting </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="localApps" name="reqType" @(DLIC?.IsLocalApps == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Local Apps (SmartSign) </span>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="printerConfig" name="reqType" @(DLIC?.IsPrinterConfiguration == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; "> Printer Configuration </span>
                            </td>
                            <td colspan="3" align='left' font-weight: normal;">
                                <input disabled type="checkbox" class="wd mr-2" id="sharedFolderAccess" name="reqType" @(DLIC?.IsOthers == true ? "checked" : "")>
                                <span style="height: 25px; font-weight: normal; width: 85%; border-radius: 0; ">
                                    @if (DLIC?.IsOthers != null && DLIC?.IsOthers == true)
                                    {
                                        @(DLIC?.OthersText)
                                    }
                                </span>
                            </td>
                        </tr>


                        <tr>
                            <td colspan="6" align='left' style="height: 25px;">
                                <span style=" width: 85%; font-weight: bold; border-radius: 0; ">Business Justification</span>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="6" align='left' style="height: 25px;">
                                <span style="height: 25px; width: 85%; font-weight: normal; border-radius: 0; "></span>
                                <input style="width: 100%" value="@(DLIC?.BusinessNeed)">
                            </td>
                        </tr>
                    </table>
                    @*<table style="width: 100%; font-size: 14px; color: #000; font-weight: 600;" border="1" cellspacing="0" cellpadding="0">
                        @if (appList.Count > 0)
                        {
                            <tr>
                                <td>Name</td>
                                <td>Proccessed On</td>
                                <td>Status</td>
                                <td>Level</td>
                            </tr>
                            foreach (var item in appList)
                            {
                                <tr>
                                    <td style="font-weight: normal;">
                                        <div style="margin-bottom:10px;">
                                            <div>@item.UserName</div>
                                            <div>@item.Designation</div>
                                        </div>
                                    </td>
                                    <td style="font-weight: normal;">
                                        @if (item.ApproverStatus != "Pending")
                                        {
                                            <div>
                                                @(item.TimeStamp.ToShortDateString() + " " + Convert.ToDateTime(item.TimeStamp).AddHours(5.5).ToShortTimeString())
                                            </div>
                                        }
                                    </td>
                                    <td colspan="1" style="font-weight: normal;">
                                        @if (item.ApproverStatus != "Pending")
                                        {
                                            <div>
                                                @item.ApproverStatus
                                            </div>
                                        }
                                    </td>
                                    <td colspan="1" style="font-weight: normal;">
                                        <div>
                                            @item.Level
                                        </div>
                                    </td>
                                </tr>
                            }
                        }
                    </table>*@
                    
                    <table style="width: 100%; font-size: 14px; color: #000; margin-top: 25px;" cellspacing="0" cellpadding="0">
                        @if (appList.Count > 0)
                        {
                            <tr>
                                @foreach (var item in appList)
                                {
                                    if (item.ApproverStatus == "Approved")
                                    {
                                        <td width="5%"></td>
                                        <td width="40%">
                                            <table style="width: 100%; font-size: 14px; color: #000;" border="1" cellspacing="0" cellpadding="0">
                                                <tr>
                                                    <td height="50px" colspan="2" align="center">
                                                        @item.ApproverStatus
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td width="50%" align="center">
                                                        @item.UserName
                                                    </td>
                                                    <td width="50%" align="center">
                                                        @(item.TimeStamp.ToShortDateString() + " " + Convert.ToDateTime(item.TimeStamp).AddHours(5.5).ToShortTimeString())
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td height="50px" colspan="2" align="center">
                                                        @item.Designation
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td width="10%"></td>
                                    }
                                }
                            </tr>
                        }
                    </table>
                </td>
            </tr>
        </table>
        @*<table style="width: 100%; font-size: 14px; color: #000; margin-top: 25px" cellspacing="0" cellpadding="0">
            <tr>
                <td width="5%"></td>
                <td width="40%">
                    <table style="width: 100%; font-size: 14px; color: #000;" border="1" cellspacing="0" cellpadding="0">
                        <tr>
                            <td height="50px" colspan="2" align="center">
                                Sign
                            </td>
                        </tr>
                        <tr>
                            <td width="50%" align="center">
                                Full name
                            </td>
                            <td width="50%" align="center">
                                Date
                            </td>
                        </tr>
                    </table>
                </td>
                <td width="10%"></td>
                <td width="40%">
                    <table style="width: 100%; font-size: 14px; color: #000;" border="1" cellspacing="0" cellpadding="0">
                        <tr>
                            <td height="50px" colspan="2" align="center">
                                Sign
                            </td>
                        </tr>
                        <tr>
                            <td width="50%" align="center">
                                Full name
                            </td>
                            <td width="50%" align="center">
                                Date
                            </td>
                        </tr>
                    </table>
                </td>
                <td width="5%"></td>
            </tr>
        </table>*@


    </body>
</html>
}
